import{j as t}from"./jsx-runtime-Cf8x2fCZ.js";import{useMDXComponents as _}from"./index-DI2gBlDf.js";import{R as w}from"./index-BlmOqGMO.js";import{M as $,S as v}from"./index-DhEtyKem.js";import"./index-yBjzXJbu.js";import"./iframe-CL1f74dY.js";import"./index-aCbGg6Ov.js";import"./index-BfFTulA3.js";import"./index-DrFu-skq.js";function C(c){const p={div:"div",..._(),...c.components};return t.jsxs(t.Fragment,{children:[t.jsx($,{title:"Embeds/Code Dynamic Snapshot"}),`
`,t.jsx("style",{children:`
  .sbdocs, .sbdocs-content { padding: 0 !important; margin: 0 !important; background: transparent !important; }
  h1, h2, h3, h4 { display: none !important; }
  .code-status { font: 12px/1.4 system-ui, Arial, sans-serif; color: #666; padding: 8px 0; }
  iframe.__code_snap_iframe { position: absolute; left: -99999px; width: 0; height: 0; border: 0; }
`}),`
`,(()=>{function g(e){const m=new URLSearchParams(window.location.search);return m.has(e)?m.get(e):new URLSearchParams(window.location.hash.replace(/^#\?/,"")).get(e)}function S(e){const m=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]),u=e.replace(/>\s+</g,"><").replace(/</g,`
<`).trim().split(`
`);let f="",l=0;for(const r of u){/^<\/[^>]+>/.test(r)&&(l=Math.max(l-1,0)),f+=" ".repeat(l)+r+`
`;const s=/^<([a-z0-9-]+)(\s|>|\/>)/i.exec(r),a=/^<[^!/][^>]_[^/]?>/.test(r),o=/^<[^>]+>._<\/[^>]+>$/.test(r);a&&s&&!m.has(s[1].toLowerCase())&&!o&&(l+=1)}return f.trim()}function j(e){return e.replace(/ data-[a-z-]+="[^"]_"/g,"").replace(/<!--.*?-->/gs,"").replace(/\sclass=""/g,"")}function k(){const e=g("codeId")||"components-button--primary",m=g("lang")||"html",u=(g("dark")||"1")==="1",[f,l]=w.useState(""),[r,s]=w.useState("Renderingâ€¦");return w.useEffect(()=>{let a=!1,o=0;const i=5;function h(){if(a||o>=i)return;o++;const E=`${window.location.origin+window.location.pathname.replace("/iframe.html","").replace("/index.html","")}/iframe.html?id=${encodeURIComponent(e)}&viewMode=story`,n=document.createElement("iframe");n.className="__code_snap_iframe",n.src=E;const x=setTimeout(()=>{a||s(`Timeout loading story (attempt ${o}/${i})`),n.remove(),o<i?setTimeout(h,1e3):s("Unable to load story content after multiple attempts")},5e3);n.onload=()=>{clearTimeout(x),setTimeout(()=>{try{const d=n.contentDocument||n.contentWindow?.document;if(!d)throw new Error("Cannot access iframe document (CORS or security restriction)");const y=d.getElementById("storybook-root");if(!y)throw new Error("Storybook root element not found");const b=y.innerHTML||"";if(!b.trim())throw new Error("Story content is empty");const M=j(b),T=S(M);a||(l(T||"<!-- No markup found -->"),s(""))}catch(d){a||(console.error("Code extraction error:",d),s(`Error (attempt ${o}/${i}): ${d.message||d}`),o<i&&setTimeout(h,2e3))}finally{n.remove()}},500)},n.onerror=()=>{clearTimeout(x),a||s(`Failed to load iframe (attempt ${o}/${i})`),n.remove(),o<i&&setTimeout(h,1e3)},document.body.appendChild(n)}return h(),()=>{a=!0}},[e]),t.jsxs(t.Fragment,{children:[r?t.jsx(p.div,{className:"code-status",children:r}):null,t.jsx(v,{code:f||"<!-- no code available -->",language:m,dark:u})]})}return t.jsx(k,{})})()]})}function X(c={}){const{wrapper:p}={..._(),...c.components};return p?t.jsx(p,{...c,children:t.jsx(C,{...c})}):C(c)}export{X as default};
